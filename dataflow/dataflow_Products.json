{
	"name": "dataflow_Products",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "DelimitedText_Products_CSV",
						"type": "DatasetReference"
					},
					"name": "sourceproducts"
				},
				{
					"dataset": {
						"referenceName": "Excel_Products",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "DerivedColumnTypeConvertions"
				},
				{
					"name": "DerivedColumn2"
				}
			],
			"script": "source(output(\n\t\tID as string,\n\t\t{N° Reseau} as string,\n\t\t{Libelle Reseau Produit} as string,\n\t\t{N° Produit} as string,\n\t\t{Libelle long Produit} as string,\n\t\t{DDV Produit} as string,\n\t\t{DEV Produit} as string,\n\t\t{Supprimé ?} as string,\n\t\t{Date Suppression} as string,\n\t\t{Libellé du Type de support} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false) ~> sourceproducts\nsource(output(\n\t\tID as string,\n\t\t{N° Reseau} as string,\n\t\t{Libelle Reseau Produit} as string,\n\t\t{N° Produit} as string,\n\t\t{Libelle long Produit} as string,\n\t\t{DDV Produit} as string,\n\t\t{DEV Produit} as string,\n\t\t{Supprimé ?} as string,\n\t\t{Date Suppression} as string,\n\t\t{Libellé du Type de support} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false) ~> source1\nsourceproducts derive(DDV_Product = iif(length({DDV Produit})==10,toDate(substring({DDV Produit},7,4)+\"-\"+substring({DDV Produit},4,2)+\"-\"+substring({DDV Produit},1,2)),toDate(substring({DDV Produit},6,4)+\"-\"+substring({DDV Produit},3,2)+\"-\"+\"0\"+substring({DDV Produit},1,1))),\n\t\tDEV_Product = iif(length({DEV Produit})==10,toDate(substring({DEV Produit},7,4)+\"-\"+substring({DEV Produit},4,2)+\"-\"+substring({DEV Produit},1,2)),toDate(substring({DEV Produit},6,4)+\"-\"+substring({DEV Produit},3,2)+\"-\"+\"0\"+substring({DEV Produit},1,1))),\n\t\t{Supprimé} = iif({Supprimé ?}=='N',0,1),\n\t\t{Date Suppression} = iif(length({Date Suppression})==10,1,0)\r\n,\n\t\tsupporttypelabel = case({Libellé du Type de support}==\"Carte sans contact\",899240000, case({Libellé du Type de support}==\"Ticket sans contact\", 899240001, case({Libellé du Type de support}==\"Ticket papier\", 899240002,899240003))),\n\t\tUnit_Group = ERROR_FUNCTION(''),\n\t\tPrice_List = ERROR_FUNCTION(''),\n\t\tUnit = ERROR_FUNCTION('')) ~> DerivedColumnTypeConvertions\nsource1 derive() ~> DerivedColumn2"
		}
	}
}